<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç –ö–≤—ñ–∑—É</title>
    <link rel="stylesheet" href="../css_code/first_quiz_style.css">
</head>
<body>

    <h1>üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ö–≤—ñ–∑—É</h1>

    <div class="results-wrapper">
        
        <div class="result-card">
            <h2 id="greeting">–í—ñ—Ç–∞—î–º–æ!</h2>
            
            <div class="score-big">
                <span id="score">0</span>/<span id="total">0</span>
            </div>

            <div class="stats">
                <div class="stat-item">
                    üë§ –ì—Ä–∞–≤–µ—Ü—å: <strong id="playerName">-</strong>
                </div>
                <div class="stat-item">
                    ‚è±Ô∏è –ß–∞—Å: <strong id="timeSpent">-</strong>
                </div>
            </div>

            <p id="message">–ß—É–¥–æ–≤–∞ —Ä–æ–±–æ—Ç–∞!</p>

            <a href="quiz.html">
                <button>–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑</button>
            </a>
        </div>

        <div class="history-card">
            <h3>üìú –Ü—Å—Ç–æ—Ä—ñ—è —ñ–≥–æ—Ä</h3>
            <div class="history-list" id="historyList">
                </div>
            <button onclick="clearHistory()" class="clear-btn">–û—á–∏—Å—Ç–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é</button>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 1. –í–Ü–î–û–ë–†–ê–ñ–ï–ù–ù–Ø –ü–û–¢–û–ß–ù–û–ì–û –†–ï–ó–£–õ–¨–¢–ê–¢–£
            const results = JSON.parse(sessionStorage.getItem('quizResults'));
            
            if (results) {
                document.getElementById('greeting').textContent = `–í—ñ—Ç–∞—î–º–æ, ${results.name}!`;
                document.getElementById('playerName').textContent = results.name;
                document.getElementById('score').textContent = results.score;
                document.getElementById('total').textContent = results.maxScore;

                const minutes = Math.floor(results.timeSpent / 60);
                const seconds = results.timeSpent % 60;
                document.getElementById('timeSpent').textContent = `${minutes} —Ö–≤ ${seconds} —Å–µ–∫`;

                const percentage = (results.score / results.maxScore) * 100;
                const msgElement = document.getElementById('message');
                
                if (percentage === 100) msgElement.textContent = "ü•á –ù–µ–π–º–æ–≤—ñ—Ä–Ω–æ! –í–∏ –≥–µ–Ω—ñ–π!";
                else if (percentage >= 50) msgElement.textContent = "üëç –ù–µ–ø–æ–≥–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!";
                else msgElement.textContent = "üìö –¢—Ä–µ–±–∞ —â–µ —Ç—Ä–æ—Ö–∏ –ø–æ–ø—Ä–∞–∫—Ç–∏–∫—É–≤–∞—Ç–∏—Å—è!";
            } else {
                // –Ø–∫—â–æ –≤—ñ–¥–∫—Ä–∏–ª–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –±–µ–∑ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–µ—Å—Ç—É
                window.location.href = 'quiz.html';
            }

            // 2. –í–Ü–î–û–ë–†–ê–ñ–ï–ù–ù–Ø –Ü–°–¢–û–†–Ü–á
            const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            const listContainer = document.getElementById('historyList');
            
            // –°–æ—Ä—Ç—É—î–º–æ: –Ω–æ–≤—ñ –∑–≤–µ—Ä—Ö—É
            history.reverse().forEach((game) => {
                const item = document.createElement('div');
                item.className = 'history-item';
                
                // –§–æ—Ä–º–∞—Ç—É—î–º–æ —á–∞—Å –¥–ª—è —ñ—Å—Ç–æ—Ä—ñ—ó
                const m = Math.floor(game.timeSpent / 60);
                const s = game.timeSpent % 60;
                const timeStr = m > 0 ? `${m}—Ö–≤ ${s}—Å` : `${s}—Å–µ–∫`;

                item.innerHTML = `
                    <div class="h-header">
                        <span class="h-name">${game.name}</span>
                        <span class="h-score">${game.score}/${game.maxScore}</span>
                    </div>
                    <div class="h-footer">
                        <span>‚è±Ô∏è ${timeStr}</span>
                        <span style="font-size: 0.8em; opacity: 0.7;">${game.date || ''}</span>
                    </div>
                `;
                listContainer.appendChild(item);
            });
            
            if (history.length === 0) {
                listContainer.innerHTML = '<p style="text-align:center; opacity:0.6; padding-top:20px;">–ü–æ–∫–∏ –Ω–µ–º–∞—î –∑–∞–ø–∏—Å—ñ–≤</p>';
            }
        });

        function clearHistory() {
            if(confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—é —ñ—Å—Ç–æ—Ä—ñ—é —ñ–≥–æ—Ä?')) {
                localStorage.removeItem('quizHistory');
                location.reload();
            }
        }
    </script>
</body>
</html>
